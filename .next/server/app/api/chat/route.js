"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},55315:e=>{e.exports=require("path")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},32250:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{POST:()=>u,runtime:()=>d});var s=r(73278),o=r(45002),i=r(54877);let n=new(r(95732)).ZP({apiKey:process.env.OPENAI_API_KEY}),p=process.env.OPENAI_ASSISTANT_ID||"asst_Xxj6YDxMDmNHkSq9iMgflz8F";async function u(e){let t=new TextEncoder,r=new TransformStream,a=r.writable.getWriter(),s=async e=>{await a.write(t.encode(`data: ${JSON.stringify(e)}

`))};try{let t;if(!process.env.OPENAI_API_KEY)throw Error("OpenAI API key is missing");let o=await e.formData(),i=o.get("message"),u=o.get("threadId");t=u?await n.beta.threads.retrieve(u):await n.beta.threads.create(),await n.beta.threads.messages.create(t.id,{role:"user",content:i});let d=await n.beta.threads.runs.create(t.id,{assistant_id:p}),c=await n.beta.threads.runs.retrieve(t.id,d.id);for(;"queued"===c.status||"in_progress"===c.status;)await new Promise(e=>setTimeout(e,1e3)),c=await n.beta.threads.runs.retrieve(t.id,d.id);if("completed"===c.status){let e=(await n.beta.threads.messages.list(t.id)).data.filter(e=>"assistant"===e.role).pop();if(e)for(let t of e.content)"text"===t.type&&await s({type:"content",content:t.text.value});await s({type:"done",threadId:t.id})}else throw Error(`Run failed: ${c.last_error?.message||"Unknown error"}`);return await a.close(),new Response(r.readable,{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}catch(e){return console.error("Error in chat API:",e),await s({type:"error",content:e instanceof Error?e.message:"Unknown error"}),await a.close(),new Response(r.readable,{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}}let d="nodejs",c=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"/Users/michaelbraian/Documents/VisualStudioCode/Bolt2/app/api/chat/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:m}=c,w="/api/chat/route";function x(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},73278:(e,t,r)=>{e.exports=r(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[379,732],()=>r(32250));module.exports=a})();